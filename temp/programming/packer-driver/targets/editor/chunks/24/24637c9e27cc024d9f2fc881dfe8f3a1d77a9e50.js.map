{"version":3,"sources":["file:///D:/File/Cocos/ECS_Demo/assets/src/ecs/systems/RenderSystem.ts"],"names":["Component","Prefab","_decorator","instantiate","World","EntityType","SystemType","Arrow","TransformComponent","ccclass","property","RenderSystem","world","type","Render","onLoad","instance","addSystemToCycle","onUpdate","entities","newEntitiesInThisCycle","i","length","entity","arrow","PrefabArrow","getComponent","transform","node","parent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,W,OAAAA,W;;AAE/BC,MAAAA,K,iBAAAA,K;;AACAC,MAAAA,U,iBAAAA,U;AAAYC,MAAAA,U,iBAAAA,U;;AACZC,MAAAA,K,iBAAAA,K;;AACAC,MAAAA,kB,iBAAAA,kB;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;yBAGTS,Y,WADpBF,OAAO,CAAC,cAAD,C,UAEHC,QAAQ,CAACT,MAAD,C,2BAFb,MACqBU,YADrB,SAC0CX,SAD1C,CACuE;AAAA;AAAA;;AAAA;;AAAA,eAInEY,KAJmE;AAAA,eAMnEC,IANmE,GAMhD;AAAA;AAAA,wCAAWC,MANqC;AAAA;;AAQzDC,QAAAA,MAAM,GAAS;AACrB;AAAA;AAAA,8BAAMC,QAAN,CAAeC,gBAAf,CAAgC,IAAhC;AACH;;AAEDC,QAAAA,QAAQ,GAAS;AACb,cAAIC,QAAQ,GAAG,KAAKP,KAAL,CAAWQ,sBAA1B;;AAEA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,QAAQ,CAACG,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACtC,gBAAIE,MAAM,GAAGJ,QAAQ,CAACE,CAAD,CAArB;;AAEA,gBAAIE,MAAM,CAACV,IAAP,KAAgB;AAAA;AAAA,0CAAWN,KAA/B,EAAsC;AAClC,kBAAIiB,KAAK,GAAGrB,WAAW,CAAC,KAAKsB,WAAN,CAAX,CAA8BC,YAA9B;AAAA;AAAA,iCAAZ;AACAF,cAAAA,KAAK,CAACD,MAAN,GAAeA,MAAf;AACAC,cAAAA,KAAK,CAACG,SAAN,GAAkBJ,MAAM,CAACG,YAAP;AAAA;AAAA,2DAAlB;AACAF,cAAAA,KAAK,CAACI,IAAN,CAAWC,MAAX,GAAoB,KAAKD,IAAzB;AACH;AAEJ;AACJ;;AA1BkE,O;;;;;iBAE7C,I","sourcesContent":["import { Component, Prefab, _decorator, instantiate } from \"cc\";\r\nimport { ESystem } from \"../System\";\r\nimport { World } from \"../World\";\r\nimport { EntityType, SystemType } from \"../Config\";\r\nimport { Arrow } from \"../prefab/Arrow\";\r\nimport { TransformComponent } from \"../components/TransformComponent\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('RenderSystem')\r\nexport default class RenderSystem extends Component implements ESystem {\r\n    @property(Prefab)\r\n    PrefabArrow: Prefab = null;\r\n\r\n    world: World;\r\n\r\n    type: SystemType = SystemType.Render;\r\n\r\n    protected onLoad(): void {\r\n        World.instance.addSystemToCycle(this);\r\n    }\r\n\r\n    onUpdate(): void {\r\n        let entities = this.world.newEntitiesInThisCycle;\r\n\r\n        for (let i = 0; i < entities.length; i++) {\r\n            let entity = entities[i];\r\n\r\n            if (entity.type === EntityType.Arrow) {\r\n                let arrow = instantiate(this.PrefabArrow).getComponent(Arrow);\r\n                arrow.entity = entity;\r\n                arrow.transform = entity.getComponent(TransformComponent);\r\n                arrow.node.parent = this.node;\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n}"]}