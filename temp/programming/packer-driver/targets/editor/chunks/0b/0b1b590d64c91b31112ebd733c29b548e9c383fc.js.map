{"version":3,"sources":["file:///D:/File/Cocos/ECS_Demo/assets/src/state-machine/GameActorState.ts"],"names":["GameActorStateBase","GameActorWalk","GameActorIdle","v3","GameTool","type","StateType","NONE","machine","time","onEnter","onuUpdate","deltaTime","onExit","WALK","actor","percent","animWalkTime","prefabAnimFrame","spriteActor","sfWalk","reverseNode","scale","node","moveComp","moveSpeed","x","IDLE","animIdleTime","sfIdle"],"mappings":";;;6FAIaA,kB,EA4BAC,a,EA2BAC,a;;;;;;;;;;;;;;;;;;;;;;;AA3DJC,MAAAA,E,OAAAA,E;;AACFC,MAAAA,Q;;;;;;;;;oCAGMJ,kB,GAAN,MAAMA,kBAAN,CAAyB;AAAA;AAAA,eAC5BK,IAD4B,GACVC,SAAS,CAACC,IADA;AAAA,eAG5BC,OAH4B,GAGA,IAHA;AAAA,eAK5BC,IAL4B,GAKb,CALa;AAAA;;AAO5BC,QAAAA,OAAO,GAAG,CAET;;AAEDC,QAAAA,SAAS,CAACC,SAAD,EAAoB;AACzB,eAAKH,IAAL,IAAaG,SAAb;AACH;;AAEDC,QAAAA,MAAM,GAAG;AACL,eAAKL,OAAL,GAAe,IAAf;AACH;;AAjB2B,O;;2BAoBpBF,S,0BAAAA,S;AAAAA,QAAAA,S,CAAAA,S;AAAAA,QAAAA,S,CAAAA,S;AAAAA,QAAAA,S,CAAAA,S;AAAAA,QAAAA,S,CAAAA,S;AAAAA,QAAAA,S,CAAAA,S;eAAAA,S;;;+BAQCL,a,GAAN,MAAMA,aAAN,SAA4BD,kBAA5B,CAA+C;AAAA;AAAA;AAAA,eAClDK,IADkD,GAChCC,SAAS,CAACQ,IADsB;AAAA;;AAGlDH,QAAAA,SAAS,CAACC,SAAD,EAA0B;AAC/B,gBAAMD,SAAN,CAAgBC,SAAhB;AAEA,cAAIG,KAAK,GAAG,KAAKP,OAAL,CAAaO,KAAzB;AACA,cAAIC,OAAO,GAAI,KAAKP,IAAL,GAAYM,KAAK,CAACE,YAAnB,GAAmC,CAAjD;AACA;AAAA;AAAA,oCAASC,eAAT,CAAyBH,KAAK,CAACI,WAA/B,EAA4CJ,KAAK,CAACK,MAAlD,EAA0DJ,OAA1D;AAEA,eAAKK,WAAL;AACH;;AAEDA,QAAAA,WAAW,GAAG;AACV,cAAIN,KAAK,GAAG,KAAKP,OAAL,CAAaO,KAAzB;AACA,cAAIO,KAAK,GAAGnB,EAAE,CAACY,KAAK,CAACQ,IAAN,CAAWD,KAAZ,CAAd;;AAEA,cAAIP,KAAK,CAACS,QAAN,CAAeC,SAAf,CAAyBC,CAAzB,GAA6B,CAAjC,EAAoC;AAChCJ,YAAAA,KAAK,CAACI,CAAN,GAAU,CAAV;AACH,WAFD,MAEO,IAAIX,KAAK,CAACS,QAAN,CAAeC,SAAf,CAAyBC,CAAzB,GAA6B,CAAjC,EAAoC;AACvCJ,YAAAA,KAAK,CAACI,CAAN,GAAU,CAAC,CAAX;AACH;;AAEDX,UAAAA,KAAK,CAACQ,IAAN,CAAWD,KAAX,GAAmBA,KAAnB;AACH;;AAxBiD,O;;+BA2BzCpB,a,GAAN,MAAMA,aAAN,SAA4BF,kBAA5B,CAA+C;AAAA;AAAA;AAAA,eAClDK,IADkD,GAChCC,SAAS,CAACqB,IADsB;AAAA;;AAGlDhB,QAAAA,SAAS,CAACC,SAAD,EAA0B;AAC/B,gBAAMD,SAAN,CAAgBC,SAAhB;AAEA,cAAIG,KAAK,GAAG,KAAKP,OAAL,CAAaO,KAAzB;AACA,cAAIC,OAAO,GAAI,KAAKP,IAAL,GAAYM,KAAK,CAACa,YAAnB,GAAmC,CAAjD;AACA;AAAA;AAAA,oCAASV,eAAT,CAAyBH,KAAK,CAACI,WAA/B,EAA4CJ,KAAK,CAACc,MAAlD,EAA0Db,OAA1D;AACH;;AATiD,O","sourcesContent":["import { v3 } from \"cc\";\r\nimport GameTool from \"../GameTool\";\r\nimport GameActorMachine from \"./GameActorMachine\";\r\n\r\nexport class GameActorStateBase {\r\n    type: StateType = StateType.NONE;\r\n\r\n    machine: GameActorMachine = null;\r\n\r\n    time: number = 0;\r\n\r\n    onEnter() {\r\n\r\n    }\r\n\r\n    onuUpdate(deltaTime: number) {\r\n        this.time += deltaTime;\r\n    }\r\n\r\n    onExit() {\r\n        this.machine = null;\r\n    }\r\n}\r\n\r\nexport enum StateType {\r\n    NONE,\r\n    IDLE,\r\n    WALK,\r\n    ATTACK,\r\n    DIE,\r\n}\r\n\r\nexport class GameActorWalk extends GameActorStateBase {\r\n    type: StateType = StateType.WALK;\r\n    \r\n    onuUpdate(deltaTime: number): void {\r\n        super.onuUpdate(deltaTime);\r\n\r\n        let actor = this.machine.actor;\r\n        let percent = (this.time / actor.animWalkTime) % 1;\r\n        GameTool.prefabAnimFrame(actor.spriteActor, actor.sfWalk, percent);\r\n\r\n        this.reverseNode();\r\n    }\r\n\r\n    reverseNode() {\r\n        let actor = this.machine.actor;\r\n        let scale = v3(actor.node.scale);\r\n\r\n        if (actor.moveComp.moveSpeed.x > 0) {\r\n            scale.x = 1;\r\n        } else if (actor.moveComp.moveSpeed.x < 0) {\r\n            scale.x = -1;\r\n        }\r\n\r\n        actor.node.scale = scale;\r\n    }\r\n}\r\n\r\nexport class GameActorIdle extends GameActorStateBase {\r\n    type: StateType = StateType.IDLE;\r\n\r\n    onuUpdate(deltaTime: number): void {\r\n        super.onuUpdate(deltaTime);\r\n\r\n        let actor = this.machine.actor;\r\n        let percent = (this.time / actor.animIdleTime) % 1;\r\n        GameTool.prefabAnimFrame(actor.spriteActor, actor.sfIdle, percent);\r\n    }\r\n}"]}