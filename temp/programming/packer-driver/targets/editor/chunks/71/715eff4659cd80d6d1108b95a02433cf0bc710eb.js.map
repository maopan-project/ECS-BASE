{"version":3,"sources":["file:///F:/ACode/CocosCode/ECS_Demo/assets/src/ecs/systems/RenderSystem.ts"],"names":["Component","Prefab","_decorator","instantiate","GameActor","GameBullet","EntityType","SystemType","World","ccclass","property","RenderSystem","world","type","Render","onLoad","instance","addSystemToCycle","onUpdate","entities","newEntitiesInThisCycle","i","length","entity","uiBase","Actor","PrefabActor","getComponent","Bullet","PrefabBullet","node","parent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,W,OAAAA,W;;AAC/BC,MAAAA,S,iBAAAA,S;;AACFC,MAAAA,U;;AAEEC,MAAAA,U,iBAAAA,U;AAAYC,MAAAA,U,iBAAAA,U;;AAEdC,MAAAA,K;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;yBAGTS,Y,WAChBD,QAAQ,CAACT,MAAD,C,UAGRS,QAAQ,CAACT,MAAD,C,EALZQ,O,qBAAD,MACqBE,YADrB,SAC0CX,SAD1C,CACsE;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAOlEY,KAPkE,GAOnD,IAPmD;AAAA,eASlEC,IATkE,GAS/C;AAAA;AAAA,wCAAWC,MAToC;AAAA;;AAWxDC,QAAAA,MAAM,GAAS;AACrB;AAAA;AAAA,8BAAMC,QAAN,CAAeC,gBAAf,CAAgC,IAAhC;AACH;;AAEDC,QAAAA,QAAQ,GAAS;AACb,cAAIC,QAAQ,GAAG,KAAKP,KAAL,CAAWQ,sBAA1B;;AAEA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,QAAQ,CAACG,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACtC,gBAAIE,MAAM,GAAGJ,QAAQ,CAACE,CAAD,CAArB;AACA,gBAAIG,MAAkB,GAAG,IAAzB;;AAEA,gBAAID,MAAM,CAACV,IAAP,KAAgB;AAAA;AAAA,0CAAWY,KAA/B,EAAsC;AAClCD,cAAAA,MAAM,GAAGrB,WAAW,CAAC,KAAKuB,WAAN,CAAX,CAA8BC,YAA9B;AAAA;AAAA,yCAAT;AACH,aAFD,MAEO,IAAIJ,MAAM,CAACV,IAAP,KAAgB;AAAA;AAAA,0CAAWe,MAA/B,EAAuC;AAC1CJ,cAAAA,MAAM,GAAGrB,WAAW,CAAC,KAAK0B,YAAN,CAAX,CAA+BF,YAA/B;AAAA;AAAA,2CAAT;AACH;;AAED,gBAAIH,MAAJ,EAAY;AACRA,cAAAA,MAAM,CAACD,MAAP,GAAgBA,MAAhB;AACAC,cAAAA,MAAM,CAACM,IAAP,CAAYC,MAAZ,GAAqB,KAAKD,IAA1B;AACH;AAEJ;AACJ;;AAlCiE,O;;;;;iBAE5C,I;;;;;;;iBAGC,I","sourcesContent":["import { Component, Prefab, _decorator, instantiate } from \"cc\";\r\nimport { GameActor } from \"../../ui/GameActor\";\r\nimport GameBullet from \"../../ui/GameBullet\";\r\nimport GameUIBase from \"../../ui/GameUIBase\";\r\nimport { EntityType, SystemType } from \"../framework/ECSConfig\";\r\nimport System from \"../framework/System\";\r\nimport World from \"../framework/World\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass\r\nexport default class RenderSystem extends Component implements System {\r\n    @property(Prefab)\r\n    PrefabActor: Prefab = null;\r\n\r\n    @property(Prefab)\r\n    PrefabBullet: Prefab = null;\r\n\r\n    world: World = null;\r\n\r\n    type: SystemType = SystemType.Render;\r\n\r\n    protected onLoad(): void {\r\n        World.instance.addSystemToCycle(this);\r\n    }\r\n\r\n    onUpdate(): void {\r\n        let entities = this.world.newEntitiesInThisCycle;\r\n\r\n        for (let i = 0; i < entities.length; i++) {\r\n            let entity = entities[i];\r\n            let uiBase: GameUIBase = null;\r\n\r\n            if (entity.type === EntityType.Actor) {\r\n                uiBase = instantiate(this.PrefabActor).getComponent(GameActor);\r\n            } else if (entity.type === EntityType.Bullet) {\r\n                uiBase = instantiate(this.PrefabBullet).getComponent(GameBullet);\r\n            }\r\n\r\n            if (uiBase) {\r\n                uiBase.entity = entity;\r\n                uiBase.node.parent = this.node;\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n}"]}